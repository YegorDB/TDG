(()=>{"use strict";var t={d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Dimensions:()=>_,UTILS:()=>u});var s={};t.r(s),t.d(s,{CircleCommands:()=>p,EllipseCommands:()=>w,EllipseRadiuses:()=>y,PathCommands:()=>v,Point:()=>f,PointsCommands:()=>g});var r={};t.r(r),t.d(r,{CanvasCircle:()=>C,CanvasEllipse:()=>P,CanvasItem:()=>x,CanvasPath:()=>S,CanvasPathItem:()=>b,CanvasPolygon:()=>I,CanvasPolyline:()=>E,CanvasText:()=>A});var i={};t.r(i),t.d(i,{SVGAnimate:()=>$,SVGAnimateMotion:()=>T,SVGAnimateTransform:()=>j,SVGCircle:()=>D,SVGEllipse:()=>B,SVGGroup:()=>Z,SVGItem:()=>V,SVGPath:()=>z,SVGPolygon:()=>W,SVGPolyline:()=>R,SVGSet:()=>k,SVGText:()=>U});var a={};t.r(a),t.d(a,{canvas:()=>O,svg:()=>q});var n={};t.r(n),t.d(n,{canvas:()=>r,svg:()=>i});var h={};t.r(h),t.d(h,{BaseLayer:()=>H});var o={};t.r(o),t.d(o,{CanvasLayer:()=>Q,CanvasLayerWithBGFiller:()=>J,CanvasLayerWithBGImage:()=>K});var d={};t.r(d),t.d(d,{SVGLayer:()=>X});var l={};t.r(l),t.d(l,{base:()=>h,canvas:()=>o,svg:()=>d});var c={};t.r(c),t.d(c,{Screen:()=>Y});var m={};t.r(m),t.d(m,{base:()=>e,create:()=>a,items:()=>n,layers:()=>l,path_commands:()=>s,screens:()=>c});const u={createSvgElement:t=>document.createElementNS("http://www.w3.org/2000/svg",t)};class _{static validateInstanceof(t){if(!(t instanceof _))throw Error("Value has to be an instance of Dimensions.")}static validateDimension(t){if(!Number.isInteger(t))throw Error("Dimension value has to be an integer.")}constructor(t,e){_.validateDimension(t),_.validateDimension(e),this._width=t,this._height=e}get width(){return this._width}get height(){return this._height}}class v{static NONE="none";static validate(t){if("string"!=typeof t)throw Error("Path commands has to be an string.");if(t==v.NONE)return;let e=["(M((\\s+\\d+){2})+)","(m((\\s+\\-?\\d+){2})+)"].join("|"),s=["(\\s+[LT]((\\s+\\d+){2})+)","(\\s+[lt]((\\s+\\-?\\d+){2})+)","(\\s+[HV](\\s+\\d+)+)","(\\s+[hv](\\s+\\-?\\d+)+)","(\\s+[C](((\\s+\\d+){2}){3})+)","(\\s+[c](((\\s+\\-?\\d+){2}){3})+)","(\\s+[SQ](((\\s+\\d+){2}){2})+)","(\\s+[sq](((\\s+\\-?\\d+){2}){2})+)","(\\s+[A]((\\s+\\d+){2}\\s+\\-?\\d+(\\s+[01]){2}(\\s+\\d+){2})+)","(\\s+[a]((\\s+\\d+){2}\\s+\\-?\\d+(\\s+[01]){2}(\\s+\\-?\\d+){2})+)"].join("|"),r=new RegExp(`^\\s*(${e})(${s})((\\s+(${e}))?(${s}))*(\\s+[Zz])?\\s*$`);if(!t.match(r))throw Error("Wrond path commands string.")}constructor(t){this.value=t||v.NONE}get value(){return this._value}set value(t){v.validate(t),this._value=t}}class f{static validateCoordinate(t){if(!Number.isInteger(t))throw Error("Point coordinate has to be an integer.")}static getInstance(t){return t instanceof f?t:new f(...t)}constructor(t,e){this.x=t,this.y=e}[Symbol.toPrimitive](t){return"string"===t?`${this.x} ${this.y}`:null}get x(){return this._x}set x(t){f.validateCoordinate(t),this._x=t}get y(){return this._y}set y(t){f.validateCoordinate(t),this._y=t}}class g extends v{static validateItems(t){if(!Array.isArray(t))throw Error("Points items has to be an Array instance.");for(let e of t){if(!Array.isArray(e)||2!=e.length)throw Error("Point coordinates has to be array of two integers.");for(let t of e)f.validateCoordinate(t)}}constructor(t,e){super(),this._options=e||{},this.items=t}*[Symbol.iterator](){for(let t of this.items)yield t}get items(){return this._items}set items(t){g.validateItems(t),this._items=this._createItems(t),this._setValue()}_setValue(){if(!this.items)return;let t=this.items.map(((t,e)=>`${0===e?"M":"L"} ${t}`));this._options.isClose&&t.push("Z"),this.value=t.join(" ")}_createItems(t){return t.map((t=>new f(...t)))}}class y{static validateValue(t){if(!Number.isInteger(t))throw Error("Radius value has to be an integer.")}constructor(t,e){this.first=t,this.second=e}[Symbol.toPrimitive](t){return"string"===t?`${this.first} ${this.second}`:null}get first(){return this._first}set first(t){return y.validateValue(t),this._first=t}get second(){return this._second}set second(t){return y.validateValue(t),this._second=t}}class w extends v{constructor(t,e){super(),this.centre=t,this.radiuses=e}get centre(){return this._centre}set centre(t){this._centre=f.getInstance(t),this._setValue()}get radiuses(){return this._radiuses}set radiuses(t){this._radiuses=t instanceof y?t:new y(...t),this._setValue()}_setValue(){if(!this.centre||!this.radiuses)return;let t=new f(this.centre.x-this.radiuses.first,this.centre.y),e=new f(this.centre.x+this.radiuses.first,this.centre.y);this.value=[`M ${t}`,`A ${this.radiuses} 0 1 0 ${e} ${this.radiuses} 0 0 0 ${t}`,"Z"].join(" ")}}class p extends w{constructor(t,e){super(t,[e,e]),this._radius=e}get radius(){return this._radius}set radius(t){this.radiuses=[t,t],this._radius=t}}class x{constructor(t){t={stroke:!0,...t||{}},this.stroke=t.stroke,this.fill=t.fill,this.flatParams=t.flatParams,this.byMethodParams=t.byMethodParams}get stroke(){return this._stroke}set stroke(t){this._stroke=!!t,this._refresh()}get fill(){return this._fill}set fill(t){this._fill=!!t,this._refresh()}get flatParams(){return this._flatParams}set flatParams(t){this._flatParams={...t},this._refresh()}get byMethodParams(){return this._byMethodParams}set byMethodParams(t){this._byMethodParams={...t},this._refresh()}get layer(){return this._layer}set layer(t){this._layer=t}draw(){if(!this.layer)throw Error("Object has no layer to draw to.");this.layer.ctx.save(),this._setFlatParams(),this._setByMethodParams(),this.stroke&&this._drawStroke(),this.fill&&this._drawFill(),this.layer.ctx.restore()}_drawStroke(){throw Error("_drawStroke() method need to be overriden")}_drawFill(){throw Error("_drawFill() method need to be overriden")}setFlatParam(t,e){if("string"!=typeof t)throw Error("Name has to be a string.");this._flatParams={...this._flatParams||{},[t]:e},this._refresh()}setByMethodParam(t,e){if("string"!=typeof t)throw Error("Name has to be a string.");if(!Array.isArray(e))throw Error("Arguments have to be an array.");this._byMethodParams={...this._byMethodParams||{},[t]:e},this._refresh()}_setFlatParams(){if(this.flatParams)for(let[t,e]of Object.entries(this.flatParams))this.layer.ctx[t]=e}_setByMethodParams(){if(this.byMethodParams)for(let[t,e]of Object.entries(this.byMethodParams))this.layer.ctx[t](...e)}_refresh(){this.layer&&this.layer.refresh()}remove(){}}class b extends x{get commands(){return new v(null)}get path(){return this.commands.value}_drawStroke(){let t=new Path2D(this.path);this.layer.ctx.stroke(t)}_drawFill(){let t=new Path2D(this.path);this.layer.ctx.fill(t)}_refresh(){this._commands&&super._refresh()}}class C extends b{constructor(t,e,s){super(s),this.commands=new p(t,e),this._centre=t,this._radius=e}get centre(){return this._centre}set centre(t){this.commands.centre=t,this._centre=t,this._refresh()}get radius(){return this._radius}set radius(t){this.commands.radius=t,this._radius=t,this._refresh()}get commands(){return this._commands}set commands(t){if(!(t instanceof p))throw Error("Commands value has to be an CircleCommands instance.");this._commands=t,this._centre=t.centre,this._radius=t.radius,this._refresh()}}class P extends b{constructor(t,e,s){super(s),this.commands=new w(t,e),this._centre=t,this._radiuses=e}get centre(){return this._centre}set centre(t){this.commands.centre=t,this._centre=t,this._refresh()}get radiuses(){return this._radiuses}set radiuses(t){this.commands.radiuses=t,this._radiuses=t,this._refresh()}get commands(){return this._commands}set commands(t){if(!(t instanceof w))throw Error("Commands value has to be an EllipseCommands instance.");this._commands=t,this._centre=t.centre,this._radiuses=t.radiuses,this._refresh()}}class S extends b{constructor(t,e){super(e),this.value=t}get value(){return this._value}set value(t){this.commands=new v(t),this._value=t,this._refresh()}get commands(){return this._commands}set commands(t){if(!(t instanceof v))throw Error("Commands value has to be an PathCommands instance.");this._commands=t,this._value=t.value,this._refresh()}}class E extends b{static COMMANDS_OPTIONS={};constructor(t,e){super(e),this.points=t}get points(){return this._points}set points(t){this.commands=new g(t,this.constructor.COMMANDS_OPTIONS),this._points=t,this._refresh()}get commands(){return this._commands}set commands(t){if(!(t instanceof g))throw Error("Commands value has to be an PointsCommands instance.");this._commands=t,this._points=t.items,this._refresh()}}class I extends E{static COMMANDS_OPTIONS={isClose:!0}}class A extends x{constructor(t,e,s){super(s),this._value=t,this.centre=e}get value(){return this._value}set value(t){this._value=t,this._refresh()}get centre(){return this._centre}set centre(t){this._centre=f.getInstance(t),this._refresh()}_drawStroke(){this.layer.ctx.strokeText(this.value,this.centre.x,this.centre.y)}_drawFill(){this.layer.ctx.fillText(this.value,this.centre.x,this.centre.y)}}const O={circle:(t,e,s)=>new C(t,e,s),ellipse:(t,e,s)=>new P(t,e,s),path:(t,e)=>new S(t,e),polygon:(t,e)=>new I(t,e),polyline:(t,e)=>new E(t,e),text:(t,e,s)=>new A(t,e,s)};class M{constructor(t){this.data={},this._parent=t}get values(){return Object.values(this.data)}add(t,e){if(t in this.data)throw Error(`Item with name "${t}" already exists.`);this.data[t]=e}remove(t){if(!(t in this.data))throw Error(`Item with name "${t}" does not exist.`);this.data[t].remove(),delete this.data[t]}}class N extends M{add(t,e){super.add(t,e),e.layer=this._parent,e.draw()}remove(t){super.remove(t),this._parent.refresh()}}class L extends M{add(t,e){super.add(t,e),this._parent.element.appendChild(e.element)}}class G{constructor(t,e){this.element=u.createSvgElement(t),e=e||{};for(let[t,s]of Object.entries(e))this.setAttr(t,s);this.items=new L(this)}getAttr(t){return this.element.getAttribute(t)}setAttr(t,e){this.element.setAttribute(t,e)}rmAttr(t){this.element.removeAttribute(t)}remove(){for(let t of this.items.values)t.remove();this.element.remove(),this.element=null}}class V extends G{constructor(t,e){super(t,e={fill:"none",stroke:"#000000",...e||{}})}}class F extends G{constructor(t,e,s){super(t,e),s=s||{};for(let[t,e]of Object.entries(s))this.element.addEventListener(t,e)}}class $ extends F{constructor(t,e){(t=t||{}).end||t.max||t.repeatDur||t.repeatCount||(t.repeatCount="indefinite"),super("animate",t)}}class k extends F{constructor(t,e){super("set",t)}}class T extends F{constructor(t,e){super("animateMotion",t)}}class j extends F{constructor(t,e){super("animateTransform",t)}}class D extends V{constructor(t,e,s){super("path",s),this.commands=new p(t,e),this._centre=t,this._radius=e}get centre(){return this._centre}set centre(t){this.commands.centre=t,this._centre=t,this.setAttr("d",this.commands.value)}get radius(){return this._radius}set radius(t){this.commands.radius=t,this._radius=t,this.setAttr("d",this.commands.value)}get commands(){return this._commands}set commands(t){if(!(t instanceof p))throw Error("Commands value has to be an CircleCommands instance.");this._commands=t,this._centre=t.centre,this._radius=t.radius,this.setAttr("d",this.commands.value)}}class B extends V{constructor(t,e,s){super("path",s),this.commands=new w(t,e),this._centre=t,this._radiuses=e}get centre(){return this._centre}set centre(t){this.commands.centre=t,this._centre=t,this.setAttr("d",this.commands.value)}get radiuses(){return this._radiuses}set radiuses(t){this.commands.radiuses=t,this._radiuses=t,this.setAttr("d",this.commands.value)}get commands(){return this._commands}set commands(t){if(!(t instanceof w))throw Error("Commands value has to be an EllipseCommands instance.");this._commands=t,this._centre=t.centre,this._radiuses=t.radiuses,this.setAttr("d",this.commands.value)}}class Z extends G{constructor(t){super("g",t)}}class z extends V{constructor(t,e){super("path",e),this.value=t}get value(){return this._value}set value(t){this.commands=new v(t),this._value=t,this.setAttr("d",this.commands.value)}get commands(){return this._commands}set commands(t){if(!(t instanceof v))throw Error("Commands value has to be an PathCommands instance.");this._commands=t,this._value=t.value,this.setAttr("d",this.commands.value)}}class R extends V{static COMMANDS_OPTIONS={};constructor(t,e){super("path",e),this.points=t}get points(){return this._points}set points(t){this.commands=new g(t,this.constructor.COMMANDS_OPTIONS),this._points=t,this.setAttr("d",this.commands.value)}get commands(){return this._commands}set commands(t){if(!(t instanceof g))throw Error("Commands value has to be an PointsCommands instance.");this._commands=t,this._points=t.items,this.setAttr("d",this.commands.value)}}class W extends R{static COMMANDS_OPTIONS={isClose:!0}}class U extends V{constructor(t,e,s){super("text",s),this.value=t,this.centre=e}get value(){return this._value}set value(t){this._value=t,this.element.textContent=t}get centre(){return this._centre}set centre(t){this._centre=f.getInstance(t),this.setAttr("x",this._centre.x),this.setAttr("y",this._centre.y)}}const q={animate:(t,e)=>new $(t,e),set:(t,e)=>new k(t,e),animateMotion:(t,e)=>new T(t,e),animateTransform:(t,e)=>new j(t,e),item:(t,e)=>new V(t,e),circle:(t,e,s)=>new D(t,e,s),ellipse:(t,e,s)=>new B(t,e,s),path:(t,e)=>new z(t,e),polygon:(t,e)=>new W(t,e),polyline:(t,e)=>new R(t,e),text:(t,e,s)=>new U(t,e,s),group:t=>new Z(t)};class H{constructor(){this.element=this.createElement(),this.items=null,this._zIndex=null,this._initialZIndex=null,this._isShowed=!0}get dimensions(){return this._dimensions}set dimensions(t){_.validateInstanceof(t),this._dimensions=t,this.element.setAttribute("width",t.width),this.element.setAttribute("height",t.height)}get isShowed(){return this._isShowed}get zIndex(){return this._zIndex}set zIndex(t){if(!Number.isInteger(t))throw Error("Z-index value has to be an integer.");null===this._initialZIndex&&(this._initialZIndex=t),this.element.style.zIndex=t,this._zIndex=t}resetZIndex(){null!==this._initialZIndex&&(this.zIndex=this._initialZIndex)}createElement(){let t=this._createElement();return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t}_createElement(){}show(){this._isShowed=!0,this.element.style.display="block"}hide(){this._isShowed=!1,this.element.style.display="none"}}class Q extends H{constructor(t){t=t||{},super(),this.ctx=this.element.getContext("2d"),this.items=new N(this),this._drawFunct=t.drawFunct}get dimensions(){return this._dimensions}set dimensions(t){super.dimensions=t,this.refresh()}refresh(){this.clear(),this._draw()}clear(){this.ctx.clearRect(0,0,this.dimensions.width,this.dimensions.height)}_draw(){this._drawFunct&&this._drawFunct(this.ctx);for(let t of this.items.values)t.draw()}_createElement(){return document.createElement("canvas")}}class J extends Q{constructor(t,e){super(e),this.bgFiller=t}get bgFiller(){return this._bgFiller}set bgFiller(t){this._bgFiller=t,this.dimensions&&this.refresh()}_draw(){this._drawBGFiller(),super._draw()}_drawBGFiller(){this.ctx.save(),this.ctx.fillStyle=this.bgFiller,this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.ctx.restore()}}class K extends Q{constructor(t,e){super(e=e||{}),this._repetition=e.repetition||"repeat",this._image=new Image,this._image.onload=()=>{this.refresh()},this.imageSrc=t}get imageSrc(){return this._imageUrl}set imageSrc(t){this._image.src=t}_draw(){this._drawBGImage(),super._draw()}_drawBGImage(){this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(this._image,this._repetition),this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.ctx.restore()}}class X extends H{constructor(){super(),this.items=new L(this)}_createElement(){return u.createSvgElement("svg")}}class Y{constructor(t,e){this.element=document.getElementById(t),this.element.style.position="relative",e=e||{};let[s,r]=e.dimensions||[100,100];this.dimensions=new _(s,r),this.layers={},this._activeLayerName=null}get dimensions(){return this._dimensions}set dimensions(t){_.validateInstanceof(t),this._dimensions=t,this.element.style.width=`${t.width}px`,this.element.style.height=`${t.height}px`}addLayer(t,e){if(t in this.layers)throw Error(`Layer with name "${t}" already exists.`);e.zIndex=Object.keys(this.layers).length,e.dimensions=this.dimensions,this.layers[t]=e,this.element.appendChild(e.element),this._activeLayerName&&this.activateLayer(this._activeLayerName)}activateLayer(t){if(!(t in this.layers))throw Error(`Layer with name "${t}" does not exist.`);this.deactivateLayer(),this.layers[t].zIndex=Object.keys(this.layers).length,this._activeLayerName=t}deactivateLayer(){null!=this._activeLayerName&&(this.layers[this._activeLayerName].resetZIndex(),this._activeLayerName=null)}createCanvasLayer(t,e){let s=new Q(e);return this.addLayer(t,s),s}createCanvasLayerWithBGFiller(t,e,s){let r=new J(e,s);return this.addLayer(t,r),r}createCanvasLayerWithBGImage(t,e,s){let r=new K(e,s);return this.addLayer(t,r),r}createSVGLayer(t){let e=new X;return this.addLayer(t,e),e}}window.TDG=m})();